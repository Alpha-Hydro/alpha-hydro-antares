<?php
/**
 * @var $page Media_Model_Media
 */

$this->title = 'Пресса';
$this->secondary_text = $this->categoryName.'Список публикаций';

?>

    <table class="table table-striped table-bordered">
        <thead>
        <tr>
            <th>ID</th>
            <?php if(!$this->categoryName):?>
                <th>Категория</th>
            <?php endif;?>
            <th>Заголовок</th>
            <th>Привязка к разделу сайта</th>
            <th>Сортировка</th>
            <th>Активность</th>
            <th>Действия</th>
        </tr>
        </thead>
        <?php if($this->pages):?>
            <?php foreach ($this->pages as $page):?>
                <tr class="<?=$this->contextualClassTr($page);?>">
                    <td><?=$page->getId()?></td>
                    <?php if(!$this->categoryName):?>
                        <td><?=($this->getCategory($page->getCategoryId(), 'media'))
                                ?$this->getCategory($page->getCategoryId(), 'media')->getName()
                                :'нет';
                            ?></td>
                    <?php endif;?>
                    <td><?=$page->getName()?></td>
                    <td>
                        <div class="select-feedback">
                            <?=$this->formSelect('sectionSite_'.$page->getId(),
                                $page->getSectionSiteId(),
                                array(
                                    'class'=>'form-control sectionSite',
                                    'data-itemId' => $page->getId()
                                ),
                                $this->getSectionSite())?>
                            <span class="glyphicon glyphicon-ok select-control-feedback" aria-hidden="true"></span>
                        </div>
                    </td>
                    <td><?=$page->getSorting()?></td>
                    <td>
                        <a href="<?= $this->url(array(
                            'module' => 'admin',
                            'controller' => 'media',
                            'action' => 'enable',
                            'id'=>$page->getId(),
                            'page'=>$this->currentPage
                        ), 'adminEdit', true, false); ?>" title="<?=($page->getActive() != 0)?'скрыть':'показать'?>">
                            <span class="glyphicon <?=($page->getActive() != 0)?'glyphicon-eye-open':'glyphicon-eye-close'?>"></span>
                        </a>
                    </td>
                    <td width="150px">
                        <?=$this->partial('_button_group_table.phtml', array(
                            'item_controller' => 'media',
                            'item_id' => $page->getId(),
                            'item_path' => '/media/'.$page->getFullPath(),
                            'deleted' => ($page->getDeleted() != 0)? true : false,
                        ))?>
                    </td>
                </tr>
            <?php endforeach;?>
        <?php endif;?>
    </table>
<?= $this->render('components/_paginator.phtml')?>